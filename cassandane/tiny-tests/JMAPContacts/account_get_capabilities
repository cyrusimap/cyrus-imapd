#!perl
use Cassandane::Tiny;

sub test_account_get_capabilities
    :min_version_3_9
    ($self)
{
    my $jmap = $self->{jmap};
    my $caldav = $self->{caldav};
    my $http = $self->{instance}->get_service("http");
    my $admintalk = $self->{adminstore}->get_client();

    xlog "Get session object";

    my $session = $jmap->get_client_session->client_session;

    $self->assert_not_null($session);

    my $capas = $session->{accounts}{cassandane}{accountCapabilities}{'urn:ietf:params:jmap:contacts'};
    $self->assert_not_null($capas);

    $self->assert_equals(JSON::true, $capas->{mayCreateAddressBook});
}
